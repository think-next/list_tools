<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>List Tools</title>
  <link rel="stylesheet" href="popup.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <meta name="color-scheme" content="light dark">
  <meta name="theme-color" content="#111827">
  <meta name="referrer" content="no-referrer">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="robots" content="noindex,nofollow">
</head>

<body>
  <div class="container">
    <!-- 首页 -->
    <div id="homepage" class="page active">
      <div class="page-header">
        <h1 class="page-title">List Tools</h1>
      </div>

      <section class="search-section">
        <div class="search-wrapper">
          <div class="search-container">
            <input id="searchInput" type="text" placeholder="输入list搜索工具..." autocomplete="off" />
            <div class="search-icon">🔍</div>
          </div>
          <div id="searchSuggestions" class="search-suggestions" style="display: none;"></div>
        </div>
      </section>

      <section class="card tools-section">
        <div class="tools-grid" id="builtin-tools">
          <!-- H3 Index 工具 -->
          <div class="tool-card" data-tool="h3">
            <div class="tool-icon">⬢</div>
            <div class="tool-content">
              <h3>H3 Index</h3>
              <p>经纬度转H3网格索引</p>
            </div>
          </div>

          <!-- 新增工具占位符 -->
          <div class="tool-card add-tool" data-tool="add">
            <div class="tool-icon">➕</div>
            <div class="tool-content">
              <h3>新增工具</h3>
              <p>点击创建新的工具</p>
            </div>
          </div>
        </div>

        <!-- 自定义工具区域 -->
        <div id="custom-tools-section" class="custom-tools-section" style="display: none;">
          <h3 class="custom-tools-title">自定义工具</h3>
          <div class="tools-grid" id="custom-tools"></div>
        </div>
      </section>
    </div>

    <!-- H3 Index 工具页面 -->
    <div id="h3-tool" class="page">
      <div class="tool-header">
        <div class="tool-title-section">
          <div class="tool-icon-large">⬢</div>
          <h1>H3 Index</h1>
        </div>
        <div class="tool-description-section">
          <p class="tool-description">经纬度转H3网格索引，支持扩圈，提供六边形预览和详细的地理数据计算功能</p>
        </div>
      </div>

      <!-- Tab 切换 -->
      <div class="tab-container">
        <div class="tab-buttons">
          <button id="coordTab" class="tab-button active" data-tab="coord">坐标计算</button>
          <button id="gridTab" class="tab-button" data-tab="grid">网格计算</button>
          <button id="fenceTab" class="tab-button" data-tab="fence">围栏计算</button>
        </div>
      </div>

      <!-- 坐标计算 Tab -->
      <section id="coordSection" class="card inputs active-tab">
        <div class="input-row">
          <div class="field main-field">
            <label for="latlng">经纬度</label>
            <input id="latlng" type="text" inputmode="decimal" placeholder="经度,纬度 (如: -122.418,37.775)" />
          </div>
          <div class="field tiny-field">
            <label for="res">网格级别</label>
            <input id="res" type="number" min="0" max="15" value="10" />
          </div>
          <div class="field tiny-field">
            <label for="ring">扩圈</label>
            <input id="ring" type="number" min="0" max="10" value="0" />
          </div>
        </div>
        <p id="error" class="error" hidden></p>
      </section>

      <!-- 网格计算 Tab -->
      <section id="gridSection" class="card inputs">
        <div class="input-row">
          <div class="field main-field">
            <label for="h3Index">H3网格索引</label>
            <input id="h3Index" type="text" placeholder="输入H3网格索引 (如: 8a1fb46622dffff)" value="8a1fb46622dffff" />
          </div>
        </div>
        <p id="gridError" class="error" hidden></p>
      </section>

      <!-- 围栏计算 Tab -->
      <section id="fenceSection" class="card inputs">
        <div class="input-row">
          <div class="field main-field">
            <label for="fenceInput">围栏坐标</label>
            <textarea id="fenceInput" rows="4"
              placeholder="输入围栏坐标点，用分号分隔&#10;格式：经度,纬度;经度,纬度;...&#10;例如：&#10;116.400691,39.907426;116.400359,39.906849;116.400123,39.907123"></textarea>
          </div>
        </div>
        <div class="input-row">
          <div class="field tiny-field">
            <label for="fenceRes">网格级别</label>
            <input id="fenceRes" type="number" min="0" max="15" value="10" />
          </div>
        </div>
        <p id="fenceError" class="error" hidden></p>
      </section>

      <div class="results-section">
        <section class="card result">
          <!-- 当前网格信息 -->
          <div class="result-section">
            <h3 class="section-title">当前网格信息</h3>
            <div class="row">
              <span class="label">H3 索引</span>
              <code id="cell" class="mono"></code>
            </div>
            <div class="row">
              <span class="label">中心点</span>
              <code id="center-point" class="mono"></code>
            </div>
            <div class="row">
              <span class="label">父单元</span>
              <code id="parent" class="mono"></code>
            </div>
            <div class="row">
              <span class="label">顶点距离 <span class="info" data-tip="顶点距离：计算中心点到各个顶点的距离">ⓘ</span></span>
              <code id="edge-length" class="mono"></code>
            </div>
            <div class="row">
              <span class="label">面积</span>
              <code id="hex-area" class="mono"></code>
            </div>
            <div class="row verts-row">
              <span class="label">顶点串</span>
              <div id="vertsText" class="mono verts-display"></div>
            </div>
          </div>

          <!-- 扩圈信息 -->
          <div id="ring-section" class="result-section" style="display: none;">
            <h3 class="section-title">扩圈信息</h3>
            <div class="row">
              <span class="label">扩圈数量</span>
              <code id="ring-count" class="mono"></code>
            </div>
            <div class="row verts-row">
              <span class="label">扩圈网格</span>
              <div id="ring-cells" class="mono verts-display"></div>
            </div>
            <div class="row verts-row">
              <span class="label">所有顶点坐标</span>
              <div class="vertex-coords-container">
                <div id="all-vertex-coords" class="mono verts-display"></div>
                <button id="copyVertexCoordsBtn" class="copy-btn" title="复制所有顶点坐标">📋</button>
              </div>
            </div>

            <!-- 边界提取 & 蜂窝围栏（参考围栏计算） -->
            <div class="row verts-row">
              <span class="label">边界提取</span>
              <div class="vertex-coords-container">
                <div id="ring-boundary-coords" class="mono verts-display"></div>
                <button id="copyRingBoundaryCoordsBtn" class="copy-btn" title="复制边界坐标">📋</button>
              </div>
            </div>
            <div class="row verts-row">
              <span class="label">蜂窝围栏</span>
              <div class="vertex-coords-container">
                <div id="ring-honeycomb-coords" class="mono verts-display"></div>
                <button id="copyRingHoneycombBtn" class="copy-btn" title="复制蜂窝围栏坐标">📋</button>
              </div>
            </div>
          </div>

          <!-- 围栏计算结果 -->
          <div id="fence-result-section" class="result-section" style="display: none;">
            <h3 class="section-title">围栏计算结果</h3>
            <div class="row">
              <span class="label">覆盖网格数量</span>
              <code id="fence-cell-count" class="mono"></code>
            </div>
            <div class="row verts-row">
              <span class="label">覆盖网格列表</span>
              <div class="vertex-coords-container">
                <div id="fence-cells" class="mono verts-display"></div>
                <button id="copyFenceCellsBtn" class="copy-btn" title="复制覆盖网格列表">📋</button>
              </div>
            </div>
            <div class="row verts-row">
              <span class="label">所有顶点坐标</span>
              <div class="vertex-coords-container">
                <div id="fence-all-vertex-coords" class="mono verts-display"></div>
                <button id="copyFenceVertexCoordsBtn" class="copy-btn" title="复制所有顶点坐标">📋</button>
              </div>
            </div>
            <div class="row verts-row">
              <span class="label">边界提取</span>
              <div class="vertex-coords-container">
                <div id="fence-boundary-coords" class="mono verts-display"></div>
                <button id="copyFenceBoundaryCoordsBtn" class="copy-btn" title="复制边界坐标">📋</button>
              </div>
            </div>
            <div class="row verts-row">
              <span class="label">蜂窝围栏</span>
              <div class="vertex-coords-container">
                <div id="fence-honeycomb-coords" class="mono verts-display"></div>
                <button id="copyFenceHoneycombBtn" class="copy-btn" title="复制蜂窝围栏坐标">📋</button>
              </div>
            </div>
          </div>
        </section>
      </div>

      <button id="backBtn" class="back-btn">← 返回</button>
      <footer class="footer">基于 H3 网格系统 · h3-js</footer>
    </div>

    <!-- 围栏计算子页面 -->
    <div id="fence-tool" class="page">
      <div class="tool-header">
        <div class="tool-title-section">
          <div class="tool-icon-large">🔲</div>
          <h1>围栏计算</h1>
        </div>
        <div class="tool-description-section">
          <p class="tool-description">基于H3网格的围栏计算功能，支持围栏区域分析和网格覆盖计算</p>
        </div>
      </div>

      <section class="card inputs">
        <div class="input-row">
          <div class="field main-field">
            <label for="fenceInput">围栏坐标</label>
            <textarea id="fenceInput" rows="4"
              placeholder="输入围栏坐标点，每行一个坐标点&#10;格式：经度,纬度&#10;例如：&#10;-122.418,37.775&#10;-122.419,37.776&#10;-122.420,37.775"></textarea>
          </div>
        </div>
        <div class="input-row">
          <div class="field tiny-field">
            <label for="fenceRes">网格级别</label>
            <input id="fenceRes" type="number" min="0" max="15" value="10" />
          </div>
        </div>
        <p id="fenceError" class="error" hidden></p>
      </section>

      <div class="results-section">
        <section class="card result">
          <div class="result-section">
            <h3 class="section-title">围栏计算结果</h3>
            <div class="row">
              <span class="label">覆盖网格数量</span>
              <code id="fence-cell-count" class="mono"></code>
            </div>
            <div class="row verts-row">
              <span class="label">覆盖网格列表</span>
              <div id="fence-cells" class="mono verts-display"></div>
            </div>
          </div>
        </section>
      </div>

      <button id="fenceBackBtn" class="back-btn">← 返回</button>
      <footer class="footer">基于 H3 网格系统 · h3-js</footer>
    </div>
  </div>
  <script type="module" src="src/popup.js"></script>

  <!-- 新增工具模态框 -->
  <div id="addToolModal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>新增自定义工具</h2>
        <button id="closeModal" class="close-btn">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="toolName">工具名称</label>
          <input type="text" id="toolName" placeholder="请输入工具名称" maxlength="20">
        </div>
        <div class="form-group">
          <label for="toolUrl">跳转链接</label>
          <input type="url" id="toolUrl" placeholder="https://example.com">
        </div>
      </div>
      <div class="modal-footer">
        <button id="cancelBtn" class="btn btn-secondary">取消</button>
        <button id="saveBtn" class="btn btn-primary">保存</button>
      </div>
    </div>
  </div>

</body>

</html>

</html>